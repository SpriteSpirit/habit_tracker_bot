# Трекер полезных привычек (Backend)

### **Контекст**

В 2018 году Джеймс Клир написал книгу «Атомные привычки», которая посвящена приобретению новых полезных привычек и
искоренению старых плохих привычек. Заказчик прочитал книгу, впечатлился и обратился с запросом реализовать трекер
полезных привычек.

В рамках учебного курсового проекта реализована бэкенд-часть SPA веб-приложения.

### **Функционал**

Backend-часть приложения предоставляет API для взаимодействия с фронтом и Telegram-ботом.

Основные возможности:

* **Управление привычками:** добавление, редактирование, удаление привычек.
* **Интеграция с Telegram:** отправка уведомлений о задачах через бота.
* **Пагинация:** разделение данных на страницы для удобства отображения.
* **Валидация данных:** проверка корректности вводимых данных.
* **Управление правами доступа:** обеспечение безопасности данных пользователей.
* **Отложенные задачи:** использование Celery для планирования задач (например, отправки уведомлений).

### **Технологии**

* **Django:** фреймворк для разработки веб-приложений на Python.
* **Django REST Framework:** фреймворк для создания REST API.
* **Celery:** система для обработки отложенных задач.
* **Telegram Bot API:** API для взаимодействия с Telegram-ботом.
* **Docker:** система контейнеризации для упрощения развертывания.
* **pytest:** фреймворк для тестирования.

### **Критерии приемки курсовой работы**

Проект соответствует следующим критериям:

1. **CORS:** Настроен.
2. **Telegram интеграция:** Настроена.
3. **Пагинация:** Реализована.
4. **Переменные окружения:** Использованы.
5. **Модели:** Все необходимые модели описаны или переопределены.
6. **Эндпоинты:** Все необходимые эндпоинты реализованы.
7. **Валидаторы:** Все необходимые валидаторы настроены.
8. **Права доступа:** Описанные права доступа заложены.
9. **Отложенная задача (Celery):** Настроена.
10. **Тестирование:** Проект покрыт тестами как минимум на 80%.
11. **Стиль кода:** Код оформлен в соответствии с лучшими практиками.
12. **Список зависимостей:** Имеется.
13. **Flake8:** Результат проверки Flake8 равен 100% (исключая миграции).
14. **GitHub:** Решение выложено на GitHub.

### **Установка и запуск**

**Предварительные условия:**

* Python 3.11
* PostgreSQL
* Poetry
* Redis
* Celery
* Postman

### Информация

Главное приложение проекта - **config**.
В config находятся модули **settings.py**, **urls.py** и **celery.py**

 ```  
    habit_tracker_bot/
    ├── config/
    │   ├── __init__.py
    │   ├── asgi.py
    │   ├── celery.py
    │   ├── settings.py
    │   ├── urls.py
    │   └── wsgi.py
    ├── habits/
    │   ├── migrations/
    │   ├── __init__.py
    │   ├── admin.py
    │   ├── apps.py
    │   ├── models.py
    │   ├── permissons.py
    │   ├── serializers.py
    │   ├── services.py
    │   ├── tasks.py
    │   ├── tests.py
    │   ├── urls.py
    │   ├── validators.py
    │   └── views.py
    ├── users/
    │   ├── fixtures/
    │   ├── managements/
    │   │   ├── commands/
    │   │   │   ├── __init__.py
    │   │   │   └── csu.py
    │   │   └── __init__.py
    │   ├── migrations/
    │   ├── __init__.py
    │   ├── admin.py
    │   ├── models.py
    │   ├── serializers.py
    │   ├── tests.py
    │   ├── admin.py
    │   ├── urls.py
    │   └── views.py
    ├── .env_example
    ├── .gitignore
    ├── celerybeat-schedule.db
    ├── manage.py
    ├── poetry.lock
    ├── poetry.toml
    └── README.md
```

**Установка:**

1. **Клонирование репозитория:**

```powershell
   git clone <репозиторий_GitHub>
   cd <название_репозитория>
```

2. **Установка poetry:**

```bash 
   pip install poetry
```

3. **Установка зависимостей:**

```bash 
   poetry install
```

4. **Настройка переменных окружения:**

Создайте файл .env в корне проекта и заполните его следующими переменными по шаблону .env_example:

```
DATABASE_URL=<URL_для_подключения_к_PostgreSQL>
SECRET_KEY=<секретный_ключ>
DEBUG=True  # Для разработки
... (другие необходимые переменные)
```

5. **Создание базы данных:**

```bash 
  python manage.py migrate
```

6. **Создание администратора:**

```bash 
  python manage.py csu
```

7. **Запуск сервера разработки:**

```bash 
   python manage.py runserver
```

8. **Запуск Celery (для отложенных задач Windows):**

```bash
   celery -A config worker -l info -P gevent
```

9. **Запуск Flower (для мониторинга Celery задач):**

```bash
   celery -A config flower --port=5555
```

### Тестирование

В проекте используются фикстуры, которые подгружают информацию в тесты:

- 3 пользователя:
    - администратор
    - модератор
    - пользователь
- 3 привычки

Для запуска тестов используйте следующую команду:

```bash
   python manage.py test
```

Для проверки покрытия тестами используйте coverage:

```bash
   coverage run --source='.' manage.py test
```

```bash
   coverage report
```

### **Автор**

```Халуева Ангелина||Sprite_Spirit```
